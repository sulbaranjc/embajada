{% extends "base.html" %}

{% block title %}Editar Residente - Sistema Embajada{% endblock %}

{% block content %}
<div class="container">
    <!-- HERO SECTION -->
    <section class="hero-section">
        <h1>‚úèÔ∏è Editar Residente</h1>
        <p>Modifique los datos del residente {{ residente.nombre }} {{ residente.apellido }}</p>
    </section>

    <!-- FORMULARIO -->
    <div class="card">
        <div class="card-header">
            <h2>üìù Actualizar Datos del Residente</h2>
        </div>
        
        <div class="form-container">
            {% if errores %}
            <div class="alert alert-danger">
                <h4>‚ö†Ô∏è Errores de validaci√≥n:</h4>
                <ul>
                    {% for error in errores %}
                    <li>{{ error }}</li>
                    {% endfor %}
                </ul>
            </div>
            {% endif %}

            <form method="POST" action="/residentes/editar/{{ residente.id }}" class="residente-form">
                <!-- SECCI√ìN: INFORMACI√ìN PERSONAL -->
                <fieldset class="form-section">
                    <legend>üë§ Informaci√≥n Personal</legend>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="nombre" class="required">Nombre:</label>
                            <input 
                                type="text" 
                                id="nombre" 
                                name="nombre" 
                                class="form-control"
                                value="{{ residente.nombre }}"
                                required
                                maxlength="100"
                                placeholder="Ingrese el nombre">
                            <small class="form-text">M√≠nimo 2 caracteres, solo letras</small>
                        </div>

                        <div class="form-group">
                            <label for="apellido" class="required">Apellido:</label>
                            <input 
                                type="text" 
                                id="apellido" 
                                name="apellido" 
                                class="form-control"
                                value="{{ residente.apellido }}"
                                required
                                maxlength="100"
                                placeholder="Ingrese el apellido">
                            <small class="form-text">M√≠nimo 2 caracteres, solo letras</small>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="fecha_nacimiento" class="required">Fecha de Nacimiento:</label>
                            <input 
                                type="date" 
                                id="fecha_nacimiento" 
                                name="fecha_nacimiento" 
                                class="form-control"
                                value="{{ residente.fecha_nacimiento }}"
                                required
                                max="{{ today }}">
                            <small class="form-text">No puede ser fecha futura</small>
                        </div>

                        <div class="form-group">
                            <label for="estado_civil">Estado Civil:</label>
                            <select id="estado_civil" name="estado_civil" class="form-control">
                                <option value="">-- Seleccione --</option>
                                <option value="Soltero" {% if residente.estado_civil == 'Soltero' %}selected{% endif %}>Soltero</option>
                                <option value="Soltera" {% if residente.estado_civil == 'Soltera' %}selected{% endif %}>Soltera</option>
                                <option value="Casado" {% if residente.estado_civil == 'Casado' %}selected{% endif %}>Casado</option>
                                <option value="Casada" {% if residente.estado_civil == 'Casada' %}selected{% endif %}>Casada</option>
                                <option value="Divorciado" {% if residente.estado_civil == 'Divorciado' %}selected{% endif %}>Divorciado</option>
                                <option value="Divorciada" {% if residente.estado_civil == 'Divorciada' %}selected{% endif %}>Divorciada</option>
                                <option value="Viudo" {% if residente.estado_civil == 'Viudo' %}selected{% endif %}>Viudo</option>
                                <option value="Viuda" {% if residente.estado_civil == 'Viuda' %}selected{% endif %}>Viuda</option>
                                <option value="Uni√≥n Libre" {% if residente.estado_civil == 'Uni√≥n Libre' %}selected{% endif %}>Uni√≥n Libre</option>
                            </select>
                            <small class="form-text">Opcional</small>
                        </div>
                    </div>
                </fieldset>

                <!-- SECCI√ìN: DOCUMENTACI√ìN -->
                <fieldset class="form-section">
                    <legend>üìã Documentaci√≥n</legend>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="pasaporte" class="required">N√∫mero de Pasaporte:</label>
                            <input 
                                type="text" 
                                id="pasaporte" 
                                name="pasaporte" 
                                class="form-control"
                                value="{{ residente.pasaporte }}"
                                required
                                maxlength="50"
                                placeholder="Ej: A1234567">
                            <small class="form-text">M√≠nimo 6 caracteres alfanum√©ricos</small>
                        </div>

                        <div class="form-group">
                            <label for="ocupacion">Ocupaci√≥n:</label>
                            <input 
                                type="text" 
                                id="ocupacion" 
                                name="ocupacion" 
                                class="form-control"
                                value="{{ residente.ocupacion if residente.ocupacion else '' }}"
                                maxlength="100"
                                placeholder="Ej: Ingeniero, M√©dico, etc.">
                            <small class="form-text">Opcional, m√°ximo 100 caracteres</small>
                        </div>
                    </div>
                </fieldset>

                <!-- SECCI√ìN: CONTACTO -->
                <fieldset class="form-section">
                    <legend>üìû Informaci√≥n de Contacto</legend>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="email" class="required">Correo Electr√≥nico:</label>
                            <input 
                                type="email" 
                                id="email" 
                                name="email" 
                                class="form-control"
                                value="{{ residente.email }}"
                                required
                                maxlength="150"
                                placeholder="ejemplo@dominio.com">
                            <small class="form-text">Debe ser un email v√°lido</small>
                        </div>

                        <div class="form-group">
                            <label for="telefono">Tel√©fono:</label>
                            <input 
                                type="tel" 
                                id="telefono" 
                                name="telefono" 
                                class="form-control"
                                value="{{ residente.telefono if residente.telefono else '' }}"
                                maxlength="50"
                                placeholder="Ej: +57 300 1234567">
                            <small class="form-text">Opcional, 7-15 d√≠gitos</small>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="direccion">Direcci√≥n de Residencia:</label>
                        <textarea 
                            id="direccion" 
                            name="direccion" 
                            class="form-control"
                            rows="3"
                            maxlength="255"
                            placeholder="Ingrese la direcci√≥n completa">{{ residente.direccion if residente.direccion else '' }}</textarea>
                        <small class="form-text">Opcional, m√°ximo 255 caracteres</small>
                    </div>
                </fieldset>

                <!-- INFORMACI√ìN ADICIONAL -->
                <div class="info-box">
                    <p><strong>üìå ID del Residente:</strong> {{ residente.id }}</p>
                    <p><strong>üìÖ √öltima modificaci√≥n:</strong> Actualizando ahora</p>
                </div>

                <!-- BOTONES DE ACCI√ìN -->
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary btn-lg">
                        üíæ Actualizar Residente
                    </button>
                    <a href="/" class="btn btn-secondary btn-lg">
                        ‚ùå Cancelar
                    </a>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
    // Convertir pasaporte a may√∫sculas autom√°ticamente
    document.getElementById('pasaporte').addEventListener('input', function(e) {
        e.target.value = e.target.value.toUpperCase();
    });

    // Establecer fecha m√°xima como hoy
    document.addEventListener('DOMContentLoaded', function() {
        const today = new Date().toISOString().split('T')[0];
        document.getElementById('fecha_nacimiento').setAttribute('max', today);
    });
</script>
{% endblock %}
